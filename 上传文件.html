<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>XMLHttpRequest上传文件</title>
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>
<input id="texrt" type="text">
<input type="file" id="file" name="myfile" style="display: none"/>
<button>上传</button>
<script type="text/javascript">
    $('#file').change(function (e) {
        console.log(e)
        if($('#file').val().indexOf('xlsx')!=-1 || $('#file').val().indexOf('xls')!=-1) {
            var fm = new FormData();
             fm.append("xlsList",$(this)[0].files[0])
            $.ajax({
            		type:"post",
            		url:"",
                    data:fm,
            		async:true,
                    processData: false,  // 不处理数据
                    contentType: false,  // 不设置内容类型
            		success:function(data) {

            		}
            	});
        }else {
            xlsx = false;
        }
    });

	$('button').click(function () {
        if($('#texrt').val()=='') {
            alert('输入框不能为空');
            return;
        }
        $('#file').trigger('click');
    })
</script>
</body>
</html>